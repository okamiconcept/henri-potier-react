(this["webpackJsonpreact-henri-pottier"]=this["webpackJsonpreact-henri-pottier"]||[]).push([[0],{17:function(e,t,a){e.exports=a(32)},31:function(e,t,a){},32:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),l=a(14),s=a.n(l),i=a(7),o=a(5),u=a(1),m=a(4),E=a.n(m),d=a(6),p=a(9),f="http://henri-potier.xebia.fr",b=function(){var e=Object(d.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/books",e.next=3,fetch(f+"/books");case 3:return t=e.sent,e.next=6,t.json();case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(d.a)(E.a.mark((function e(t){var a,n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="/books/".concat(t.join(","),"/commercialOffers"),e.next=3,fetch(f+a);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",r.offers);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}!function(e){e.INIT_ORDER="INIT_ORDER",e.ADD_TO_ORDER="ADD_TO_ORDER",e.DELETE_ORDER_ITEM="DELETE_ORDER_ITEM",e.CHANGE_QUANTITY_ORDER_ITEM="CHANGE_QUANTITY_ORDER_ITEM",e.COMMERCIAL_OFFERS_RESPONSE="COMMERCIAL_OFFERS_RESPONSE"}(n||(n={}));var N={total:0,reduction:null,count:0,items:[],offers:[]},y=Object(r.createContext)(void 0),R=Object(r.createContext)(void 0);function g(e,t){switch(t.type){case"percentage":return e.total*(t.value/100);case"minus":return t.value;case"slice":return Math.floor(e.total/t.sliceValue)*t.value}}function P(e){return e.offers.map((function(t){return{offer:t,amount:g(e,t)}})).sort((function(e,t){return e.amount<t.amount?1:-1}))[0]}function _(e){return v({},e,{count:e.items.reduce((function(e,t){return e+t.quantity}),0),total:e.items.reduce((function(e,t){return e+t.quantity*t.product.price}),0),reduction:P(e)})}function j(e){localStorage.setItem("order",JSON.stringify(e))}function T(e,t){switch(t.type){case n.INIT_ORDER:return j(e=_(e=t.payload)),v({},e);case n.ADD_TO_ORDER:var a=e.items.find((function(e){return e.product.isbn===t.payload.isbn}));return a?a.quantity++:e.items.push({id:t.payload.isbn,product:t.payload,quantity:1}),j(e=_(e)),v({},e);case n.DELETE_ORDER_ITEM:return e.items=e.items.filter((function(e){return e.id!==t.payload.id})),j(e=_(e)),v({},e);case n.CHANGE_QUANTITY_ORDER_ITEM:var r=e.items.find((function(e){return e.id===t.payload.item.id}));return r&&(r.quantity+=t.payload.quantity,r.quantity<=0&&T(e,{type:n.DELETE_ORDER_ITEM,payload:r})),j(e=_(e)),v({},e);case n.COMMERCIAL_OFFERS_RESPONSE:return e.offers=t.payload,j(e=_(e)),v({},e)}}function D(e){var t=e.children,a=Object(r.useReducer)(T,N),l=Object(u.a)(a,2),s=l[0],i=l[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("order");if(e){var t=JSON.parse(e);i({type:n.INIT_ORDER,payload:t})}}),[]),Object(r.useEffect)((function(){(function(){var e=Object(d.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s.items.length){e.next=5;break}return e.next=3,h(s.items.map((function(e){return e.product.isbn})));case 3:t=e.sent,i({type:n.COMMERCIAL_OFFERS_RESPONSE,payload:t});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[s.count,s.items]),c.a.createElement(y.Provider,{value:s},c.a.createElement(R.Provider,{value:i},t))}function w(){var e=Object(r.useContext)(y);if(void 0===e)throw new Error("useOrderState must be used within a OrderProvider");return e}function x(){var e=Object(r.useContext)(R);if(void 0===e)throw new Error("useOrderDispatch must be used within a OrderProvider");return e}function S(){return[w(),x()]}var C,I=function(){var e=S(),t=Object(u.a)(e,1)[0];return c.a.createElement("header",null,c.a.createElement("nav",{className:"navbar is-primary",role:"navigation","aria-label":"main navigation"},c.a.createElement("div",{className:"navbar-brand"},c.a.createElement(i.b,{className:"navbar-item",to:"/"},"HENRI POTTIER"),c.a.createElement("a",{role:"button",className:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"},c.a.createElement("span",{"aria-hidden":"true"}),c.a.createElement("span",{"aria-hidden":"true"}),c.a.createElement("span",{"aria-hidden":"true"}))),c.a.createElement("div",{id:"navbarBasicExample",className:"navbar-menu"},c.a.createElement("div",{className:"navbar-start"},c.a.createElement(i.b,{className:"navbar-item",to:"/products"},"Products")),c.a.createElement("div",{className:"navbar-end"},c.a.createElement("div",{className:"navbar-item"},c.a.createElement("div",{className:"buttons"},c.a.createElement(i.b,{className:"button is-info badge has-badge-rounded has-badge-danger","data-badge":t.count,to:"/cart"},c.a.createElement("span",{className:"icon"},c.a.createElement("i",{className:"fas fa-shopping-cart"})),c.a.createElement("strong",null,"View Order"))))))))},k=(a(31),function(){var e=S(),t=Object(u.a)(e,2),a=t[0],r=t[1];return c.a.createElement("section",{className:"section"},c.a.createElement("h1",{className:"title is-2"},"Your cart"),a.count?c.a.createElement("table",{className:"table is-hoverable is-fullwidth"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,c.a.createElement("abbr",{title:"Product"},"Product")),c.a.createElement("th",{className:"has-text-centered"},c.a.createElement("abbr",{title:"Quantity"},"Quantity")),c.a.createElement("th",{className:"has-text-right"},c.a.createElement("abbr",{title:"Price"},"Unit Price")),c.a.createElement("th",{className:"has-text-right"},c.a.createElement("abbr",{title:"Total Price"},"Total Price")),c.a.createElement("th",null))),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("th",null),c.a.createElement("th",null),c.a.createElement("th",{className:"has-text-right"},"Total before reduction"),c.a.createElement("th",{className:"has-text-right"},a.total.toFixed(2)," \u20ac"),c.a.createElement("th",null)),c.a.createElement("tr",null,c.a.createElement("th",null),c.a.createElement("th",null),c.a.createElement("th",{className:"has-text-right"},"Reduction",a.reduction?" (".concat(a.reduction.offer.type,")"):""),c.a.createElement("th",{className:"has-text-right"},(a.reduction?a.reduction.amount:0).toFixed(2)," ","\u20ac"),c.a.createElement("th",null)),c.a.createElement("tr",null,c.a.createElement("th",null),c.a.createElement("th",null),c.a.createElement("th",{className:"has-text-right"},"Total"),c.a.createElement("th",{className:"has-text-right"},(a.total-(a.reduction?a.reduction.amount:0)).toFixed(2)," ","\u20ac"),c.a.createElement("th",null))),c.a.createElement("tbody",null,a.items.map((function(e){return c.a.createElement("tr",{key:e.id},c.a.createElement("th",null,e.product.title),c.a.createElement("td",null,c.a.createElement("div",{className:"buttons has-addons is-centered"},c.a.createElement("button",{className:"button",onClick:function(){r({type:n.CHANGE_QUANTITY_ORDER_ITEM,payload:{item:e,quantity:-1}})}},c.a.createElement("span",{className:"icon is-small"},c.a.createElement("i",{className:"fas fa-minus-square"}))),c.a.createElement("span",{className:"button"},e.quantity),c.a.createElement("button",{className:"button",onClick:function(){r({type:n.CHANGE_QUANTITY_ORDER_ITEM,payload:{item:e,quantity:1}})}},c.a.createElement("span",{className:"icon is-small"},c.a.createElement("i",{className:"fas fa-plus-square"}))))),c.a.createElement("td",{className:"has-text-right"},e.product.price.toFixed(2)," \u20ac"),c.a.createElement("td",{className:"has-text-right"},(e.product.price*e.quantity).toFixed(2)," \u20ac"),c.a.createElement("td",{className:"has-text-right"},c.a.createElement("button",{className:"button is-danger",onClick:function(){r({type:n.DELETE_ORDER_ITEM,payload:e})}},c.a.createElement("span",{className:"icon is-small"},c.a.createElement("i",{className:"fas fa-trash-alt"})))))})))):c.a.createElement("div",null,"Your cart is empty."))}),A=function(){return c.a.createElement("div",null,"Welcome to Henri Pottier e-shop!")},M=function(e){var t=e.product,a=S(),r=Object(u.a)(a,2),l=(r[0],r[1]);return c.a.createElement("div",{className:"card"},c.a.createElement("div",{className:"card-image"},c.a.createElement("figure",{className:"image is-3by4"},c.a.createElement("img",{src:t.cover,alt:t.title}))),c.a.createElement("div",{className:"card-content"},c.a.createElement("div",{className:"media"},c.a.createElement("div",{className:"media-content"},c.a.createElement("p",{className:"title is-4"},t.title),c.a.createElement("p",{className:"subtitle is-6"},t.price," \u20ac",c.a.createElement("button",{className:"button is-info is-pulled-right",onClick:function(){l({type:n.ADD_TO_ORDER,payload:t})}},c.a.createElement("span",{className:"icon"},c.a.createElement("i",{className:"fas fa-cart-arrow-down"})),c.a.createElement("span",null,"Add to cart"))))),c.a.createElement("div",{className:"content"},t.synopsis.map((function(e,t){return c.a.createElement("p",{key:t},e)})))))};function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?q(a,!0).forEach((function(t){Object(p.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}!function(e){e.GET_PRODUCTS="GET_PRODUCTS",e.PRODUCTS_RESPONSE="PRODUCTS_RESPONSE"}(C||(C={}));var U={count:0,loading:!1,products:[]},L=Object(r.createContext)(void 0),G=Object(r.createContext)(void 0);function H(e,t){switch(t.type){case C.GET_PRODUCTS:return F({},e,{loading:!0});case C.PRODUCTS_RESPONSE:return F({},e,{products:t.payload,loading:!1})}}function Q(e){var t=e.children,a=Object(r.useReducer)(H,U),n=Object(u.a)(a,2),l=n[0],s=n[1];return Object(r.useEffect)((function(){(function(){var e=Object(d.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:t=e.sent,s({type:C.PRODUCTS_RESPONSE,payload:t});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),c.a.createElement(L.Provider,{value:l},c.a.createElement(G.Provider,{value:s},t))}function Y(){var e=Object(r.useContext)(L);if(void 0===e)throw new Error("useProductState must be used within a ProductProvider");return e}function B(){var e=Object(r.useContext)(G);if(void 0===e)throw new Error("useProductDispatch must be used within a ProductProvider");return e}var J=function(){var e=[Y(),B()],t=Object(u.a)(e,1)[0],a=Object(r.useState)(""),n=Object(u.a)(a,2),l=n[0],s=n[1],i=Object(r.useState)(t.products),o=Object(u.a)(i,2),m=o[0],E=o[1];return Object(r.useEffect)((function(){E(t.products.filter((function(e){return e.title.includes(l)})))}),[l,t.products]),c.a.createElement("section",{className:"section"},c.a.createElement("div",{className:"columns"},c.a.createElement("div",{className:"column"},c.a.createElement("h1",{className:"title is-2"},"Products")),c.a.createElement("form",{className:"column"},c.a.createElement("div",{className:"field"},c.a.createElement("p",{className:"control has-icons-left has-icons-right"},c.a.createElement("input",{className:"input",type:"text",placeholder:"Search",onChange:function(e){s(e.target.value)},value:l}),c.a.createElement("span",{className:"icon is-small is-left"},c.a.createElement("i",{className:"fas fa-search"})))))),c.a.createElement("div",{className:"columns is-multiline"},m.map((function(e){return c.a.createElement("div",{className:"column is-one-quarter",key:e.isbn},c.a.createElement(M,{product:e}))}))))},W=function(){return c.a.createElement(Q,null,c.a.createElement(J,null))},V=function(){return c.a.createElement(D,null,c.a.createElement(i.a,null,c.a.createElement("div",{className:"container"},c.a.createElement(I,null),c.a.createElement(o.c,null,c.a.createElement(o.a,{path:"/products"},c.a.createElement(W,null)),c.a.createElement(o.a,{path:"/cart"},c.a.createElement(k,null)),c.a.createElement(o.a,{path:"/"},c.a.createElement(A,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[17,1,2]]]);
//# sourceMappingURL=main.e086b155.chunk.js.map